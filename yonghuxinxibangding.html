<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
        <meta name="format-detection" content="telephone=no">
        <title>用户信息绑定</title>
        <link rel="stylesheet" type="" href="css/frozen.css">
        <link rel="stylesheet" href="css/yonghuxinxibangding.css">
        <link rel="stylesheet" href="css/public.css">
        <script src="js/jquery-1.9.1.min.js"></script>
    </head>
    <body>

		<div class="ui-panel ui-panel-pure ui-border-t bg-color">
		    <ul class="ui-list ui-list-pure user-top user-fil">
		        <div class="ui-form ui-border-t beijing">
				    <form id="formid" action="{:U('User/approve_post')}" method="post">
				        <div class="ui-form-item ui-form-item-show ui-border-b">
				            <label for="#" class="user-number">姓　　名：</label>
				            <input type="text" name="name" id="name" placeholder="请输入姓名">
				        </div>
				        <div class="ui-form-item ui-form-item-show ui-border-b">
				            <label for="#" class="user-number">身份证号：</label>
				            <input type="text" name="card_id" maxlength="18" id="card_id" placeholder="请输入身份证号">
				        </div>
				        
				        <div class="ui-form-item ui-form-item-show ui-border-b">
				            <label for="#" class="user-number">民族：</label>
				            <div class="ui-select user-number">
								<select name="sex" readonly >
									<option value="汉族">汉族</option>
	                                <option value="蒙古族">蒙古族</option>
	                                <option value="回族">回族</option>
	                                <option value="藏族">藏族</option>
	                                <option value="维吾尔族">维吾尔族</option>
	                                <option value="苗族">苗族</option>
	                                <option value="彝族">彝族</option>
	                                <option value="壮族">壮族</option>
	                                <option value="布依族">布依族</option>
	                                <option value="朝鲜族">朝鲜族</option>
	                                <option value="满族">满族</option>
	                                <option value="侗族">侗族</option>
	                                <option value="瑶族">瑶族</option>
	                                <option value="白族">白族</option>
	                                <option value="土家族">土家族</option>
	                                <option value="哈尼族">哈尼族</option>
	                                <option value="哈萨克族">哈萨克族</option>
	                                <option value="傣族">傣族</option>
	                                <option value="黎族">黎族</option>
	                                <option value="傈傈族">傈傈族</option>
	                                <option value="佤族">佤族</option>
	                                <option value="畲族">畲族</option>
	                                <option value="高山族">高山族</option>
	                                <option value="拉祜族">拉祜族</option>
	                                <option value="水族">水族</option>
	                                <option value="东乡族">东乡族</option>
	                                <option value="纳西族">纳西族</option>
	                                <option value="景颇族">景颇族</option>
	                                <option value="柯尔克孜族">柯尔克孜族</option>
	                                <option value="土族">土族</option>
	                                <option value="达翰尔族">达翰尔族</option>
	                                <option value="仫佬族">仫佬族</option>
	                                <option value="羌族">羌族</option>
	                                <option value="布朗族">布朗族</option>
	                                <option value="撒拉族">撒拉族</option>
	                                <option value="毛南族">毛南族</option>
	                                <option value="仡佬族">仡佬族</option>
	                                <option value="锡伯族">锡伯族</option>
	                                <option value="阿昌族">阿昌族</option>
	                                <option value="普米族">普米族</option>
	                                <option value="塔吉克族">塔吉克族</option>
	                                <option value="怒族">怒族</option>
	                                <option value="乌孜别克族">乌孜别克族</option>
	                                <option value="俄罗斯族">俄罗斯族</option>
	                                <option value="鄂温克族">鄂温克族</option>
	                                <option value="德昂族">德昂族</option>
	                                <option value="保安族">保安族</option>
	                                <option value="裕固族">裕固族</option>
	                                <option value="京族">京族</option>
	                                <option value="塔塔尔族">塔塔尔族</option>
	                                <option value="独龙族">独龙族</option>
	                                <option value="鄂伦春族">鄂伦春族</option>
	                                <option value="赫哲族">赫哲族</option>
	                                <option value="门巴族">门巴族</option>
	                                <option value="珞巴族">珞巴族</option>
	                                <option value="基诺族">基诺族</option>
	                                <option value="其他">其他</option>
								</select>
							</div>
				        </div>
				        <div class="ui-form-item ui-form-item-show ui-border-b">
				            <label for="#" class="user-number">性别：</label>
				            <span class="ui-select jiaji">
								<select name="sex" readonly>
									<option value="1" selected>男</option>
									<option value="0">女</option>
								</select>
							</span>
				        </div>
				         <div style="display: none;" class="ui-form-item ui-form-item-show ui-border-b">
				            <label for="#" class="user-number">年龄：</label>
				            <input type="text" name="age" readonly value="">
				        </div>
				        <div  style="display: none;"  class="ui-form-item ui-form-item-show ui-border-b">
				            <label for="#" class="user-number">出生年月日：</label>
				            <input type="text" name="born" readonly id="born" value="">
				        </div>
				        
				        <div  class="ui-form-item ui-form-item-show ui-border-b">
				            <label for="#" class="user-number approve_label">身份证有效期：</label>
				            <input type="text" name="address" id="address" placeholder="请输入身份证有效期限">
				        </div>
				        <div class="ui-form-item ui-form-item-show ui-border-b">
				            <label for="#" class="user-number">住址：</label>
				            <input type="text" name="address" id="address" placeholder="请输入身份证上的住址">
				        </div>
				        <div class="ui-form-item ui-form-item-show ui-border-b">
				            <label for="#" class="user-number">联系电话：</label>
				            <input type="text" name="tel" id="tel" maxlength="11" placeholder="请输入联系电话">
				        </div>
				        <div class="ui-form-item ui-form-item-r ui-border-b">
				            <input type="text" placeholder="请输入验证码">
				            <!-- 若按钮不可点击则添加 disabled 类 -->
				            <button type="button" class="ui-border-l btn_yzm">获取验证码</button>
				            <!--<a href="#" class="ui-icon-close"></a>-->
				        </div>
				    </form>
				</div>
		    </ul>
		    <div class="ui-btn-group user-top btn_bottom">
			    <button type="button" class="cancel quxiao_bg" onclick="window.history.back(-1);">取消</button>
			    <button class="cancel user-submit ydzjsq_bg" onclick="submit();" id="nation" >提交</button>
			</div>
			
			<footer class="ui-footer ui-footer-stable ui-border-t bottom_foot">
			    <ul class="ui-tiled footer_a">
			        <li><a href="#"><div class="foot_neirong"><img src="img/shouye.png"></div><i>首页</i></a></li>
			        <li><a href="#"><div class="foot_neirong"><img src="img/guanyuwomen.png"></div><i>关于我们</i></a></li>
			        <li><a href="#"><div class="foot_neirong"><img src="img/gerenzhongxin.png"></div><i>个人中心</i></a></li>
			    </ul>
			</footer>
			
			<script src="js/jquery-1.9.1.min.js" type="text/javascript" charset="utf-8"></script>
			<script type="text/javascript">
			var jq = $.noConflict();
            
            function submit(){
	            var name = document.getElementById("name").value;
	            var card_id = document.getElementById("card_id").value;
	            var tel = document.getElementById("tel").value;
	            var nation = document.getElementById("nation").value;
	            var address = document.getElementById("address").value;
	            if(name==""){alert('姓名不允许为空');return false;}
	            if(card_id==""){alert('身份证不允许为空');return false;}
	            if(tel==""){alert('电话不允许为空');return false;}
	            if(nation==""){alert('民族不允许为空');return false;}
	            if(address==""){alert('住址不允许为空');return false;}
	            var reg = /(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;  
				if(reg.test(card_id) === false){ alert("身份证输入不合法");return false;}  
				if(!(/^1[34578]\d{9}$/.test(tel))){ alert("手机号码有误，请重填");return false;} 
	            document.getElementById("formid").submit();
            }

            



            jq('input[name=card_id]').on('input',function(){
					if(jq(this).val().length == 18){
						IdCard(jq(this).val());
					}
				});
				function IdCard(UUserCard){
					  
					       //获取性别
					     if (parseInt(UUserCard.substr(16, 1)) % 2 == 1) {
					    	 jq('select[name=sex]').val(1);
					       
					   
					       } else {
						     jq('select[name=sex]').val(0);
					 
					       }
					
					        //获取年龄
					        var myDate = new Date();
					        var month = myDate.getMonth() + 1;
					        var day = myDate.getDate();
					        var age = myDate.getFullYear() - UUserCard.substring(6, 10) - 1;
					        if (UUserCard.substring(10, 12) < month || UUserCard.substring(10, 12) == month && UUserCard.substring(12, 14) <= day) {
					            age++;
					        }
					        jq('input[name=age]').val(age);
					        


					        jq("#card_id").bind("blur",function(){
							   var content=jq("#card_id").val();
					
							      jq("#born").val(content.slice(6,14));
							   
							});


					        //获取参保地
					         jq.ajax({
						  			url: "{:U('getUserCbd')}",
						  			type: 'POST',
						  			dataType:'json',
						  			data: {card_id:$('input[name=card_id]').val()},
						  			success:function(data){	//成功后的回调函数,返回的数据放在data参数里
						   				console.log(data.cbd);
											    //提交后刷新
											if (data.status == '1') {
											
												$('input[name=area]').val(data.cbd);
										
											}else{
												alert(data.msg);
												$('input[name=area]').attr('readonly',false);
											}
									
			
									    
						  			},
						   			error:function(status){
						   				console.log(status);
						   			}
					   			}); 
					        
					
					}
			
            </script>
		</div>



    </body>
</html>